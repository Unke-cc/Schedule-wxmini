<!--pages/index/index.wxml-->
<view class="container">
  <view class="header">
    <view class="welcome">
      <text class="greeting">你好，{{userInfo.name}}</text>
      <text class="role">{{isTeacher ? '教师' : '学生'}}</text>
    </view>
    <view class="stats">
      <view class="stat-item">
        <text class="number">{{todayTasks.length}}</text>
        <text class="label">今日任务</text>
      </view>
      <view class="stat-item">
        <text class="number">{{completedTasks}}</text>
        <text class="label">已完成</text>
      </view>
      <view class="stat-item">
        <text class="number">{{pendingTasks}}</text>
        <text class="label">待完成</text>
      </view>
    </view>
  </view>

  <view class="calendar-section">
    <calendar 
      selectedDate="{{selectedDate}}" 
      tasks="{{tasks}}"
      bind:select="onDateSelect"
    />
  </view>

  <view class="task-section">
    <view class="section-header">
      <text class="title">{{selectedDateStr}}任务</text>
    </view>

    <view class="task-list">
      <view class="empty" wx:if="{{!selectedTasks.length}}">
        <image class="empty-icon" src="/images/icons/empty.png" mode="aspectFit"></image>
        <text>暂无任务</text>
      </view>
      <view 
        class="task-item {{item.status === 'completed' ? 'completed' : ''}}"
        wx:for="{{selectedTasks}}" 
        wx:key="_id"
        bindtap="navigateToDetail"
        data-id="{{item._id}}"
      >
        <view class="task-content">
          <view class="task-info">
            <text class="task-title">{{item.title}}</text>
            <text class="task-time">{{item.startTimeStr}} - {{item.endTimeStr}}</text>
          </view>
          <view class="task-status">
            <text class="status-text">{{item.statusText}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>